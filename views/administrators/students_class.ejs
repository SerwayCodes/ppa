<!DOCTYPE html>
<html lang="en">
  <%- include('../include/head' ); -%>

  <body>
    <div class="main-wrapper">
      <%- include('../include/pageheader' ); -%> <%-
      include('../include/admin_sidebar' ); -%>
      <div class="page-wrapper">
        <div class="content container-fluid">
          <div class="page-header">
            <div class="row align-items-center">
              <div class="col">
                <h3 class="page-title">Class</h3>
                <ul class="breadcrumb">
                  <li class="breadcrumb-item"><a href="index">Class</a></li>
                  <li class="breadcrumb-item active">Class List</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <div class="card card-table">
                <div class="card-body">
                  <div class="table-responsive">
                    <table
                      id="student-table"
                      class="table table-hover table-center mb-0 datatable"
                    >
                      <thead>
                        <tr>
                          <th>Student ID</th>
                          <th>First Name</th>
                          <th>Surname</th>
                          <th>Add Result</th>
                        </tr>
                      </thead>

                      <tbody>

                        <% if (data && data.students && data.students.length > 0) { %>
                       
                        <% data.students.forEach(function(student) { %>
                        <tr>
                          <td><%= student.student_id %></td>
                          <td><%= student.first_name %></td>
                          <td><%= student.last_name %></td>
                         <td> <button
                          class="btn btn-primary"
                          onclick="getClassDetails('<%= student.student_id %>','<%= programId %>')"
                        >
                          Add Exam Results
                        </button></td>
                        </tr>
                        <% }); %>
                        <% } else { %>
                          <tr>
                            <td colspan="3">No students available</td>
                          </tr>
                          <% } %>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <%- include('../include/footer' ); -%>
      </div>
    </div>
    <%- include('../include/scripts' ); -%>
    <script>
      
   function getClassDetails(studentId,programId) {
    const student_id = encodeURIComponent(studentId)
    console.log(student_id, programId);
     // Fetch data from the server using programId
     fetch(`/administrators/fetchStudent/${student_id}`)
       .then(response => response.json()) // Assuming the server responds with JSON data
       .then(data => {
         // Redirect to another page and pass the data as a query parameter
         window.location.href = `addStudent_results?studentId=${student_id}&programId=${programId}&data=${encodeURIComponent(JSON.stringify(data))}`;
       })
       .catch(error => {
         console.error('Error:', error);
       });
   }
   
         </script>
  </body>
</html>
